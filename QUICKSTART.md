---
layout: default
title: Quick Start
nav_order: 2
---

# Quick Start
Welcome to the Quickstart guide for ThreatWinds API! This guide is designed to help you get started with using our API to retrieve information on Cybersecurity threats and their interrelationships.

To make the most of ThreatWinds, it's crucial to have a clear idea of what you want to accomplish. To assist you in achieving your goals, we provide comprehensive documentation and usage guidelines for each of our APIs. This documentation includes detailed explanations of the various APIs available to you.

Before we dive in, it's important to note that you can test our APIs using the **Swagger UI**. This interactive documentation allows you to explore the API's capabilities and experiment with different queries, making it an invaluable resource as you begin working with the APIs.

### Swagger UI Links
* [QAuth](https://intelligence.threatwinds.com/api/auth/v2/swagger/index.html)
* [SearchAPI](https://intelligence.threatwinds.com/api/search/v1/swagger/index.html)
* [IngestAPI](https://intelligence.threatwinds.com/api/ingest/v1/swagger/index.html#")


**Now, let's get started**

## Authentication {#auth}
Authentication is a crucial aspect of using our APIs. It ensures that only authorized users have access to the data and helps to maintain the security and integrity of our system. To access the different endpoints and retrieve data, you need to authenticate using an Authorization header or a KeyPairs (API key and an API secret).

When building an entire application around an API, the usage of authorization headers becomes a common approach to control user sessions and ensure the security of the application.
Once the client is authenticated, the authorization header is included in the HTTP request headers to control the user's session. This header contains a unique token that is generated by the server and sent to the client as a means to identify the user's session. The authorization header remains valid as long as the user's session is active and has not expired, providing a secure and reliable method to maintain user sessions within the application.

For developers who are planning to use an API for their own services, the key pair authentication method is often the normal approach used to authenticate and authorize API requests. This method involves the use of an API key and secret key, which are unique identifiers that are provided to the client by the API provider. 

{: .note }
Both the authorization header and the keypair need to be verified before being used.


Example of Autorizathion header when you create a session:
```json
{
    ...,
  "bearer": "m5orsH7hqidILzwkGUcjf9gl93r9KqOj",
  ...
}
```

Example of KeyPair when you create a new one:
```json
{
  "apiKey": "fq6JoEFTsxiXAl1cVxPDnK4emIQCwaUB",
  "apiSecret": "fq6JoEFTsxiXAl1cVxPDnK4emIQCwaUBfq6JoEFTsxiXAl1cVxPDnK4emIQCwaUB",
  ...
}
```
**For more information on how to create a KeyPair and a Session, please refer to the [KeyPair](./Auth/KeyPair) and [Session](./Auth/SESSION) documentation.**
<br>

{: .important}
>If you choose to use the Authorization header for authentication, you do not need to include your API key and secret as query parameters in the request. Conversely, if you include your API key and secret as query parameters, you do not need to use the Authorization header.

<h3>SearchData</h3>


Now that you have successfully authenticated, you can begin searching for information. You have the option to look up the history of entity reports, synthesized information about entities, or relationships of these entities with others by using the Search endpoint.

For example, let's say you want to retrieve malware reports from the past 5 minutes. You may also want to gather statistics on the distribution of malware per minute, identify the top active malware, and determine the quantity of each malware type present.

**STEP 1** The first thing you need to know is which endpoint to use. In this case, since you want to retrieve the latest records, you should use the <a href="./Search/HISTORY">HISTORY</a> endpoint. To do this, you will need to make a POST request to https://intelligence.threatwinds.com/api/search/v1/entities/history.

**STEP 2** The second thing you need to know is the structure of the entity you are searching for. To do this, you can consult the [Definition Page](./DEFINITIONS).

**STEP 3** Now, we need to create a query that fulfills the requirements of our use case, which are:

* Get the malware reports in the last 5 minutes.
* Get stats about the distribution per minute of those malwares.
* Get the top most active malwares and their quantity per type.

The query should look like this to achieve the user case:

```json
{
  "aggs": {
    "most-active-malwares": {
      "terms": {
        "field": "attributes.malware.keyword",
        "size": 50
      }
    },
    "malware_per_minute": {
      "date_histogram": {
        "field": "@timestamp",
        "interval": "minute"
      }
    }
  },
  "query": {
      "filter": [
        {
          "term": {
            "type": {
              "value": "malware"
            }
          }
        },
        {
          "range": {
            "@timestamp": {
              "gte": "now-5m",
              "lte": "now"
            }
          }
        }
      ]
  }
}
```
Here's how this query accomplishes these tasks:

* The **most-active-malwares** aggregation uses the <a href="./Search/queryandagg/AGGREGATIONS#terms">terms</a> aggregation to group the malware reports by their name, and then returns the top 50 most frequent ones.
* The **malware_per_minut**e aggregation uses the <a href="./Search/queryandagg/AGGREGATIONS#histogram">date_histogram</a> aggregation to group the malware reports by day.
The **query** section use a <a href="./Search/queryandagg/QUERY.md#filter">filter</a> the results to only include malware reports within the last 5 minutes.


**STEP 4**:Now we can make the request! To make it, you can use a tool like cURL or an HTTP client like Postman. Here is an example cURL command using the query you provided:

```bash
curl -X 'POST' \
  'https://intelligence.threatwinds.com/api/search/v1/entities/history' \
  -H 'accept: application/json' \
  -H 'api-key: 5i3w1FwOAGehi5Ce' \
  -H 'api-secret: HAciZAv0IODXAd2fXYEdZMAZHiOKb3En' \
  -H 'Content-Type: application/json' \
  -d '{
  "aggs": {
    "most-active-malwares": {
      "terms": {
        "field": "attributes.malware.keyword",
        "size": 50
      }
    },
    "malware_per_minute": {
      "date_histogram": {
        "field": "@timestamp",
        "interval": "minute"
      }
    }
  },
  "query": {
      "filter": [
        {
          "term": {
            "type": {
              "value": "malware"
            }
          }
        },
        {
          "range": {
            "@timestamp": {
              "gte": "now-5m",
              "lte": "now"
            }
          }
        }
      ]
  }
}'
```

**STEP 5**: After making the request, the API will respond with a JSON object containing the requested information, which may look something like the following:

```json
{
  "pages": 1000,
  "items": 10000,
  "results": [
    {
      "@timestamp": "2023-04-13T10:44:39.18885102Z",
      "attributes": {
        "malware": "pdf dropper agent",
        "malware-family": "pdf",
        "malware-type": "dropper"
      },
      "entityID": "malware-20eae8ae8ec23315a7d9f07c0cbcd3651657b8604ef02e9dfcbfd6304cb824b8",
      "id": "26690919-131c-4b04-a50d-cec2ab0dc5aa",
      "reputation": -3,
      "score": null,
      "sort": [
        1681382679188
      ],
      "tags": null,
      "type": "malware",
      "userID": "2e4ad29c-bf32-47b0-ae0d-67ec870b1677",
      "version": 1
    },
    {
      "@timestamp": "2023-04-13T10:44:35.74704415Z",
      "attributes": {
        "malware": "pdf dropper agent",
        "malware-family": "pdf",
        "malware-type": "dropper"
      },
      "entityID": "malware-20eae8ae8ec23315a7d9f07c0cbcd3651657b8604ef02e9dfcbfd6304cb824b8",
      "id": "3ea6dc17-936d-4f7e-9121-702b077681eb",
      "reputation": -3,
      "score": null,
      "sort": [
        1681382675747
      ],
      "tags": null,
      "type": "malware",
      "userID": "2e4ad29c-bf32-47b0-ae0d-67ec870b1677",
      "version": 1
    },...
    ],
    "aggregations": {
        "malware_per_minute": {
            "buckets": [
                {
                    "doc_count": 20,
                    "key": 1680393600000,
                    "key_as_string": "2023-04-02T00:00:00.000Z"
                },
                {
                    "doc_count": 16,
                    "key": 1680480000000,
                    "key_as_string": "2023-04-02T00:01:00.000Z"
                },...
            ]
        },
        "most-active-malwares": {
            "buckets": [
                {
                    "doc_count": 43,
                    "key": "win malware agent"
                },
                {
                    "doc_count": 5,
                    "key": "multios malware agent"
                },...
            ]
        }
    }
}

```

Great! You're now ready to start exploring the documentation and learn more about the Threat Winds API.
